define(["require","exports","tslib","react","external/prop-types","modules/clean/web_timing_logger","deep-integrations/avatar_popover_content/data","modules/clean/api_v2/default_user_client"],function(e,t,n,r,a,i,o,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),r=n.__importDefault(r),a=n.__importStar(a);var p=(function(e){function t(t){var n=e.call(this,t)||this;return n.mounted=!1,n.getApiV2Client=function(){return n.apiV2Client},n.getDataStore=function(){return n.state.dataStore},n.isIntegrationTooltipEnabled=function(){return n.state.isIntegrationTooltipEnabled},n.profileCardV1Enabled=function(){return n.state.profileCardV1Enabled},n.profileCardV2Enabled=function(){return n.state.profileCardV2Enabled},n.apiV2Client=new l.DefaultUserApiV2Client(n.props.user),n.state={dataStore:new o.AvatarPopoverContentDataStore(n.apiV2Client),isIntegrationTooltipEnabled:!1,profileCardV1Enabled:!1,profileCardV2Enabled:!1},n}return n.__extends(t,e),t.prototype.getChildContext=function(){return{getApiV2Client:this.getApiV2Client,getDataStore:this.getDataStore,isIntegrationTooltipEnabled:this.isIntegrationTooltipEnabled,profileCardV1Enabled:this.profileCardV1Enabled,profileCardV2Enabled:this.profileCardV2Enabled}},t.prototype.componentDidMount=function(){var e=this;this.mounted=!0,i.waitForTTI().then(function(){return n.__awaiter(e,void 0,void 0,function(){var e,t,r,a;return n.__generator(this,function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,this.apiV2Client.ns("integrations").rpc("are_features_available",{features:[{feature:"profile_card_v1",entry_point:"file_preview_top_bar"},{feature:"profile_card_v2",entry_point:"file_preview_top_bar"}]},{})];case 1:return e=n.sent(),this.mounted&&(t=!1,r=!1,e.features.forEach(function(e){"profile_card_v1"===e.feature&&"available"===e.available[".tag"]&&(t=!0),"profile_card_v2"===e.feature&&"available"===e.available[".tag"]&&(r=!0)}),this.setState({isIntegrationTooltipEnabled:t||r,profileCardV1Enabled:t,profileCardV2Enabled:r})),[3,3];case 2:return a=n.sent(),this.mounted&&this.setState({profileCardV1Enabled:!1,profileCardV2Enabled:!1}),[3,3];case 3:return[2]}})})})},t.prototype.componentWillUnmount=function(){this.mounted=!1},t.prototype.render=function(){return r.default.Children.only(this.props.children)},t.childContextTypes={getApiV2Client:a.func,getDataStore:a.func,isIntegrationTooltipEnabled:a.func,profileCardV1Enabled:a.func,profileCardV2Enabled:a.func},t})(r.default.Component);t.IntegrationProvider=p});
//# sourceMappingURL=integration_provider.min.js-vflTVgcx0.map